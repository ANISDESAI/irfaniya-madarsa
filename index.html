<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Irfaniya Masjid & Madarsa</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Noto+Nastaliq+Urdu:wght@600&display=swap" rel="stylesheet">
<style>
/* Base Styles */
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Poppins',sans-serif;
  background: linear-gradient(rgba(0,0,0,0.75),rgba(0,0,0,0.85)),url('background.jpg');
  background-size:cover;background-position:center;color:white;overflow-x:hidden;}
body::before{content:"";position:fixed;width:100%;height:100%;background:url("https://www.transparenttextures.com/patterns/arabesque.png");opacity:0.04;pointer-events:none;}
.moon{position:absolute;top:60px;right:80px;width:70px;height:70px;background:#fff;border-radius:50%;box-shadow:0 0 25px rgba(255,255,255,0.8);animation:float 6s ease-in-out infinite;}
.moon::after{content:"";position:absolute;top:0;left:22px;width:70px;height:70px;background:#000;border-radius:50%;}
@keyframes float{0%,100%{transform:translateY(0);}50%{transform:translateY(-15px);}}
header{text-align:center;padding:80px 15px 40px;}
header h1{font-size:32px;font-weight:700;letter-spacing:1px;}
.urdu{font-family:'Noto Nastaliq Urdu',serif;font-size:26px;margin-top:8px;opacity:0.95;}
.subtitle{margin-top:8px;font-weight:300;opacity:0.85;}
.container{max-width:1000px;margin:auto;padding:15px;}
.card{background:rgba(255,255,255,0.10);backdrop-filter:blur(18px);padding:25px;border-radius:25px;box-shadow:0 15px 40px rgba(0,0,0,0.6);margin-bottom:25px;}
.counter{font-size:28px;font-weight:700;color:#00e676;margin-top:8px;}
.button-group{display:flex;flex-direction:column;gap:12px;margin-top:20px;}
button{padding:14px;border:none;border-radius:30px;font-size:15px;font-weight:500;background:linear-gradient(135deg,#00e676,#00bfa5);color:#fff;cursor:pointer;transition:0.3s;}
button:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(0,0,0,0.5);}
.mosque{width:100%;height:140px;background:none;margin-top:60px;}

/* Table Styles */
.table-wrapper{overflow-x:auto;}
table{width:100%;border-collapse:collapse;margin-top:15px;min-width:500px;}
th,td{padding:10px;text-align:center;border-bottom:1px solid rgba(255,255,255,0.3);white-space:nowrap;}
th{background:rgba(0,0,0,0.5);}

/* Responsive Adjustments */
@media(max-width:768px){
  header h1{font-size:28px;}
  .urdu{font-size:22px;}
  .counter{font-size:24px;}
  table{min-width:400px;}
  th,td{padding:8px;font-size:14px;}
}
@media(max-width:480px){
  header h1{font-size:24px;}
  .urdu{font-size:20px;}
  .counter{font-size:22px;}
  table{min-width:350px;}
  th,td{padding:6px;font-size:13px;}
  .button-group{gap:10px;}
}
</style>
</head>
<body>
<div class="moon"></div>

<header>
<h1>üïå Irfaniya Masjid & Madarsa</h1>
<div class="urdu">ŸÖÿØÿ±ÿ≥€Å ÿπÿ±ŸÅÿßŸÜ€å€Å ŸÖÿ≥ÿ¨ÿØ</div>
<div class="subtitle">Donation & Funds Management</div>
</header>

<div class="container">

<div class="card">
<h2>Total Donation & Balance</h2>
<div class="counter" id="donationCounter">‚Çπ 0</div>
<div style="margin-top:10px;font-size:16px;">Balance: ‚Çπ <span id="balance">0</span></div>
</div>

<div class="card">
<h2>Manage Donations & Funds</h2>
<div class="button-group">
<button onclick="showSection('donation')">Donation List</button>
<button onclick="showSection('kharcha')">Kharcha List</button>
</div>

<!-- Donation Section -->
<div id="donation" style="display:none;" class="table-wrapper">
<table id="donationTable">
<tr>
<th>Donation #</th>
<th>Name</th>
<th>Amount (‚Çπ)</th>
<th>Date</th>
<th>Payment Method</th>
</tr>
</table>
</div>

<!-- Kharcha Section -->
<div id="kharcha" style="display:none;" class="table-wrapper">
<table id="kharchaTable">
<tr>
<th>Kharcha #</th>
<th>Purpose</th>
<th>Amount (‚Çπ)</th>
<th>Date</th>
<th>Paid From</th>
</tr>
</table>
</div>

</div>

<div class="mosque"></div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbx4lP00Q3kbRpq3ajbBxPDpgSp7QHecEKcoPNtH4mhqalnsDbAQlGB2pLSKtXIOya1i/exec"; // Replace with your Apps Script Web App URL
let donationList=[], kharchaList=[];

function showSection(id){
  document.getElementById('donation').style.display='none';
  document.getElementById('kharcha').style.display='none';
  document.getElementById(id).style.display='block';
  calculateTotals();
}

// Format ISO date to Indian format DD-MM-YYYY
function formatIndianDate(isoDate){
  if(!isoDate) return "-";
  const d = new Date(isoDate);
  const day = ("0"+d.getDate()).slice(-2);
  const month = ("0"+(d.getMonth()+1)).slice(-2);
  const year = d.getFullYear();
  return `${day}-${month}-${year}`;
}

async function fetchData(){
  try{
    const res = await fetch(API_URL);
    const data = await res.json();
    donationList = data.donations;
    kharchaList = data.kharcha;
    renderTables();
    calculateTotals();
  }catch(err){console.error(err);}
}

function renderTables(){
  // Donation Table
  const dTable=document.getElementById('donationTable');
  dTable.innerHTML="<tr><th>Donation #</th><th>Name</th><th>Amount (‚Çπ)</th><th>Date</th><th>Payment Method</th></tr>";
  donationList.forEach((d,i)=>{
    let row=dTable.insertRow();
    row.insertCell(0).innerText=i+1;
    row.insertCell(1).innerText=d.Name || "Anonymous";
    row.insertCell(2).innerText=d.Amount;
    row.insertCell(3).innerText = formatIndianDate(d.Date);
    row.insertCell(4).innerText=d.Method || "-";
  });

  // Kharcha Table
  const kTable=document.getElementById('kharchaTable');
  kTable.innerHTML="<tr><th>Kharcha #</th><th>Purpose</th><th>Amount (‚Çπ)</th><th>Date</th><th>Paid From</th></tr>";
  kharchaList.forEach((k,i)=>{
    let row=kTable.insertRow();
    row.insertCell(0).innerText=i+1;
    row.insertCell(1).innerText=k.Purpose;
    row.insertCell(2).innerText=k.Amount;
    row.insertCell(3).innerText = formatIndianDate(k.Date);
    row.insertCell(4).innerText = k.PaidFrom || "-";
  });
}

function calculateTotals(){
  let totalDonation = donationList.reduce((sum,d)=>sum+parseInt(d.Amount),0);
  let totalKharcha = kharchaList.reduce((sum,k)=>sum+parseInt(k.Amount),0);
  document.getElementById('balance').innerText = totalDonation - totalKharcha;
  animateCounter(totalDonation);
}

function animateCounter(target){
  let counter=document.getElementById('donationCounter');
  let count=0;
  let step=Math.ceil(target/120);
  let interval=setInterval(()=>{
    count+=step;
    if(count>=target){count=target;clearInterval(interval);}
    counter.innerText="‚Çπ "+count;
  },15);
}

// Initialize
fetchData();
</script>
</body>

</html>
